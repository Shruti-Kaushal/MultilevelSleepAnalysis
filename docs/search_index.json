[["index.html", "MultilevelSleepAnalysis Chapter 1 Introduction", " MultilevelSleepAnalysis Shruti Kaushal &amp; Clarissa Tai 2021-12-13 Chapter 1 Introduction This project is focused on characterizing the sleep quality of 20 healthy young adults using numerous variables like age, sex, sleep fragmentation index, mental state and heart rate to name a few. There are variables that seems to have a direct relationship with sleep, for example, sleep fragmentation index and the time spent in bed, but there are others that one wouldn’t suspect being related, like height or weight of the user. Biologists may argue that they are indeed related through many different paths but as data scientists we would like to uncover those through the data. The first step is to formulate a metric for the quality of sleep using only the variables that we know are correlated to it. This would mean defining a metric over the set of variables in the sleep.csv file of every user. Preliminary analysis is done to prevent multicollinearity. Once we have established an tested our metric, we will move on to looking into how other variables affect the distribution of the metric across users. This section will be aimed at answering questions about correlation and causality. Our ultimate goal is to identify any confounders if any and quantify their relationship with the metric we define. However, we are cognizant of the fact that the cohort size is extremely small and the results might be “overfitting” the data. That said, we were not able to find any other datasets with the same level of sampling measurements which is why we exercise caution when making all the conclusions in the upcoming sections. Note: Since we are dealing with continuous categorical data, we use scatterplots and linear regression models to establish correlations and/or causal effects "],["data-sources.html", "Chapter 2 Data sources 2.1 Dataset Overview 2.2 Data Collection", " Chapter 2 Data sources Multilevel Monitoring of Activity and Sleep in Healthy People: https://physionet.org/content/mmash/1.0.0/ CAP Sleep Database: https://physionet.org/content/capslpdb/1.0.0/ 2.1 Dataset Overview There are 22 folders in the MMASH dataset corresponding to the 22 healthy male young adults that were monitored for two consecutive days. A myriad of variables were measured for each of the samples or “users” (what the authors of the dataset calls them) including mental state, heart rate, level of clock genes in saliva, amount of sleep to the different activities that the user does throughout the days. These measurements are organized into 7 folders i.e. for each of the 22 users we have the following 7 folders: Actigraph.csv: accelerometer and inclinometer data recorded throughout the day. Activity.csv: list of the activity categories throughout the day. questionnaire.csv: scores for all the questionnaires. RR.csv: beat-to-beat interval data. saliva.csv: clock genes and hormones concentrations in the saliva before going to bed and after waking up. Melatonin levels are reported in μg of melatonin per μg of protein, while cortisol levels are in μg of cortisol per 100 μg of protein. No clock genes and hormones concentrations data was provided for User_21 due to problem in the salivary samples that do not permit to analyse it. sleep.csv: information about sleep duration and sleep quality of the participant. user_info.csv: anthropocentric characteristics of the participant, such as age, height, weight, etc. ## [1] &quot;user_11 is missing sleep.csv information, having errorError in `[&lt;-.data.frame`(`*tmp*`, \\&quot;user\\&quot;, value = \\&quot;user_11\\&quot;): replacement has 1 row, data has 0\\n&quot; 2.2 Data Collection According to the document, the data were collected and provided by BioBeats (biobeats.com) in collaboration with researchers from the University of Pisa. BioBeats operates in the health science industry that produces IoT wearable devices aiming to detect people’s psychophysiological stress. The data were recorded by sport and health scientists, psychologists and chemists with the objective of assessing psychophysiological response to stress stimuli and sleep. 22 healthy young adult males were recruited. In accordance with the Helsinki Declaration as revised in 2013, the study was approved by the Ethical Committee of the University of Pisa (#0077455/2018). At the start of the data recording, anthropomorphic characteristics (i.e. age, height and weight) of the participants were recorded. At the same time, participants filled in a set of initial questionnaires that provide information about participants psychological status: Morningness-Eveningness Questionnaire (MEQ) State-Trait Anxiety Inventory (STAI-Y) Pittsburgh Sleep Quality Questionnaire Index (PSQI) Behavioural avoidance/inhibition (BIS/BAS) During the test, participants wore two devices continuously for 24 hours: a heart rate monitor to record heartbeats and beat-to-beat interval, and an actigraph to record actigraphy information such as accelerometer data, sleep quality and physical activity. Moreover, the perceived mood (Positive and Negative Affect Schedule - PANAS) were recorded at different times of the day (i.e. 10, 14, 18, 22 and 9 of the next day). Additionally, participants filled in Daily Stress Inventory (DSI) before going to sleep, to summarize the stressful events of the day. Twice a day (i.e., before going to bed and when they woke up) the subjects collected saliva samples at home in appropriate vials. Saliva samples were used to extract RNA and measure the induction of specific clock genes, and to assess specific hormones. A washout period from drugs of at least a week was required from the participants in the study. "],["data-transformation.html", "Chapter 3 Data transformation 3.1 Sleep 3.2 Actigraph 3.3 Activity 3.4 Saliva 3.5 User info", " Chapter 3 Data transformation As mentioned in the introduction, for each sample or “user” many variables were sampled over the course of two days. These measurements are organized into 7 different files and in this section we will focus on how we transformed the data in each of the files for analysis. In conclusion, we worked on all the datetime columns and transformed them into the format YYYY-MM-DD HH:MM:SS for convenience. We decided to not include RR.csv in our discussion, since the heartbeat information is also included in the actigraph.csv. 3.1 Sleep The sleep file includes measurements like the time the user gets into bed to total minutes spent in bed, total sleep time, number of times the user wakes up etc. Every user once in bed (to sleep) doesn’t get out of bed till morning except one. Sleep records of user 1 showed that he got out of bed at 3:31 AM and went back to sleep at 3:57 AM. For simplification, we treated the time interval that the user was out of bed as an “awakening” i.e. when a user awaken from his sleep and remains awake for some time. This required updating the rest of the variables and depending on the definition , we either took the average or maximum or summed the two quantities corresponding to each of the “sleep sessions”. For example, “Total Sleep Time” was now the sum of the sleep time in both sessions, while “Sleep Fragmentation Index” was averaged across sessions. Sleep Measurements of User 1 3.2 Actigraph Actigraph.csv contained accelerometer and inclinometer data recorded throughout the day. Overall, it tracked users’ movement data, such as steps, direction, acceleration, positions, etc. We transformed the data as follows - Datetime format: We transform the time column into datetime type in R. Also, since initial time column doesn’t contain date information, we add days according to the day column to create a relative time stamp for each record in order to facilitate future calculation. Create category Position: Here we gathered columns with inclinometer information, which were Inclinometer.Off, Inclinometer.Standing, Inclinometer.Sitting, Inclinometer.Lying, transformed them into categorical column Position. By doing so, we can explore data correlations under groups of position throughout the day. 3.3 Activity This file contained information on 13 different categories of activities measured throughout the day and the time (of event happening) recorded. We transformed the data as follows - Datetime format: Here we substitute “00:00” to “24:00” in column End to avoid calculating between wrong dates, and then transformed into the format as we did for Actigraph.csv. Relabel the activities: The document labeled the activity categories from 1 to 12. However, an extra category, labeled as 0, also included in the dataset. In this project, we will assume that the 0 represented undetermined activities. Here, we also had to deal with several minor mistakes in the dataset manually. Calculate duration for each activity: To figure the total time each user spent on each activity, we calculate time intervals (End - Start) between different activities in seconds. Plotting: We explored the dataset using geom_tile in ggplot2 package. From the plot below, we noticed that user 21 was laying down for quite a long time. 3.4 Saliva Saliva.csv collected Melatonin and Cortisol concentrations in the saliva for each participants before going to bed and after waking up. From each of the two samples, the concentration of cortisol and melatonin were calculated. Melatonin levels are reported in μg per μg of protein while cortisol levels are reported in μg per 100 μg of protein. The data contains the normalized concentrations of both hormones and so no transformation or normalization was needed to use this data. 3.5 User info This file contains anthropocentric characteristics of the participant which include the gender, height in centimeters, weight in kgs and age in years. The data is pretty standard and did not require any sort of transformation "],["missing-values.html", "Chapter 4 Missing values 4.1 Missing Value Plot", " Chapter 4 Missing values Missing information includes - file information missing: user_11 is missing sleep.csv information No clock genes and hormones concentrations data was provided for User_21 due to problem in the salivary samples that do not permit to analyse it. missing age for user_18 in user_info user_13 is missing questionnaire Since the aim of our project is to define a metric for sleep quality and identify variables with that affect it, user 11 was excluded from all the analysis performed. 4.1 Missing Value Plot Here we revise the function we created in problem set 4 to plot the missing patterns. The number of missing values are very few (mentioned above). We generated missing value plots only for questionnaire and activity as they seemed to exhibit some pattern. As shown in the plots, only one row with missing values exist in activity and questionnaire, respectively. There is only one missing value in “End” variable which is defined as the time of the day when the event or activity concluded. For example, if a user smoked from 10:30 AM to 10:40 AM then End would be set to 10:40 AM. Except this one missing value, all others are complete cases. We generated this plot after removing user 13 so as to not distort the actual missing value patterns for users that have a record for questionnaire. Similar to activity, this file category has only two patterns - complete cases and two missing values that correspond to the levels of a variable “PANAS”. PANAS is defined as the positive and negative affect schedule. It gives a score rating between 5 and 50 for both positive and negative emotions and higher the value, the higher is the perceived emotion. There are only two rows that are not complete. "],["results.html", "Chapter 5 Results 5.1 Metric Formulation 5.2 Establishing Direct &amp; Indirect Effects on Sleep Quality", " Chapter 5 Results The results chapter is broadly divided into two sections - one for each of the goals of this project. The first section will document all preliminary findings related to the sleep measurements and the procedure of defining a metric for quantifying quality of sleep. 5.1 Metric Formulation 5.1.1 Preliminary Observations Formulating a metric requires an extensive analysis of the data to identify correlated variables. This is to avoid multicollinearity while defining the metric. Below is a correlation heatmap we generated for variables that do not have the format of a time stamp (for example hh:mm). We made the following observations - Latency, defined as the time taken for the user to fall asleep after he gets into bed, does not seem to be correlated with anything Total sleep time (TST) is not correlated with neither Number of Awakenings and Average Awakening Length. One would expect TST to be negatively correlated to both but that is not true Movement, Fragmentation and Sleep Fragmentation index are highly correlated. It is not surprising as sleep fragmentation index is defined as the ratio of the two Wake After Sleep Onset (WASO) is strongly positively correlated to almost every variable except for Efficiency Note: all coefficients are statistically significant with a default critical value of 0.05 5.1.2 Distribution of Variables There are 3 clusters in the heatmap (if we cut across the tree right below the highest line connecting efficiency and another cluster) which are consistent with the observations we made. To avoid multicollinearity, we decided to pick variables from each of the clusters depending on the strength and significance of the correlation coefficient. We denote our metric by M. Intuitively, it should be higher for users who are able to sleep through the night and do not have any trouble falling asleep. Keeping this in mind, we came up with the following associations - M \\(\\alpha\\) Total Sleep Time (TST) M \\(\\alpha\\) \\(\\frac{1}{SleepFragmentation Index}\\) M \\(\\alpha\\) \\(\\frac{1}{Latency}\\) M \\(\\alpha\\) \\(\\frac{1}{AverageTimeSpentAwake}\\) We combined the above associations as follows - \\[\\begin{align*} M \\alpha (\\frac{TST}{AverageTimeSpentAwake} + \\frac{1}{SleepFragmentationIndex}).\\frac{1}{Latency} \\end{align*}\\] The units of the right hand side are “per hh:mm” (because of addition of latency). Average Time Spent Awake is the product of Number of Awakenings and Average Awakening Length. Let the ratio of TST and Average Time Spent Awake be called sleep ratio. The next step was to quantify the distribution of the variables that are used to define M. We wanted to include variables that are informative instead of variables that remain constant across the cohort. Due to the small sample size, any analysis of such sort (constructing a metric) will have a selection bias and so the conclusions made throughiut this section may not hold for a bigger cohort. The box plot below shows the distribution of the Sleep Ratio and Sleep Fragmentation Index. The values for both ratios seems well distributed with no outliers. Since Latency is the time taken by the user to fall asleep once he gets into the bed, we wanted to visualize it separately. We noticed that a lot of the users had a latency time of 0 mins. This creates a problem since the metric is inversely proportional to latency and a value of infinity wouldn’t make sense. So, we add a dummy term to latency and replaced proportionality with equality. We define the sleep quality of a user as - \\[\\begin{align*} M = (\\frac{TST}{AverageTimeSpentAwake} + \\frac{1}{SleepFragmentationIndex}).(\\frac{1}{Latency + 1}) \\end{align*}\\] In the case that other variables are 0, we simply replace them by 1. We did not add a dummy terms as the none of the users in our cohort \\(TST = 0\\) or \\(Number of Awakenings = 0\\). This metric is always positive since all the variables involved are non-negative. 5.1.3 Distribution of Sleep Quality Metric We calculated the sleep quality metric for each of the users and visualized the results as a boxplot to be able to discern its distribution. The lowest value is 0.5902 corresponding to user 2 and the largest is 16.33 corresponding to user 12, who is also an outlier. We are particularly interested in investigating users that fall below the lower hinge and above the upper hinge. The former group includes users 2, 3, 8, 10 and 16. While the group with M &gt; 6.6874 includes users 1, 12, 14, 20 and 21. The rest lie within the 25th and 75th percentile of the metric data. ## min lower-hinge median upper-hinge max ## 0.5902389 1.2815906 3.0779926 6.6873567 16.3742315 Having defined the metric, we wanted to do a sanity check that it indeed is capturing the quality of sleep. The only way to do that was to compare the values of Efficiency variable to M. Efficiency is defined as the percentage of Total Sleep Time upon total sleep in bed. The reader might think that the metric defined above could have been made way simpler if Efficiency was included but we had motivation to not include it altogether. One of the things that pops out is the Efficiency is not strongly correlated to both of the variables TST and Total Minutes in Bed. This seems absurd and since we couldn’t explain why this was happening we ultimately decided to remove efficiency from the equation and instead use it as a sanity check. It is only logical to think Efficiency and sleep quality should be positively correlated. To test the relationship, we generated a log-log scale plot. The motivation behind using a log10 scale over the normal scale was first to normalize the values and second to see how the magnitudes of the two variables are related. The regression model is statistically significant with a p-value of 3.681e-05 and the positive slope indicates that as the sleep quality increases, so does the efficiency. However, caution needs to be exercised while making this conclusion as the adjusted R square value is 0.6 which means that the model captures less than 70% of the variance. In summary, the metric defined by the formula above seems to be capturing the information that directly affects the sleep quality of a user. Moreover, the statistical significance combined with the positive slope of the regression model and line prove to be a sanity check for our metric. 5.2 Establishing Direct &amp; Indirect Effects on Sleep Quality Having established a metric and quantified its distribution, we want to identify variables that have a direct or indirect relationship with sleep quality. These relationships might not necessarily be causal in nature as correlation does not imply causation. This section is divided further into subsections for each of the 7 files in the dataset. Since some of the data is redundant, we decided to analyze only 5 out of the 7 - sleep records, user information, actigraph measurements, activities performed and the saliva samples. 5.2.1 Can Going to Bed Early Improve Sleep Quality? Time and again the society and many cultures have encouraged the practice going to bed early and rising early for a healthy life and better sleep. We wanted to test this hypothesis and see if bed time does have an effect on the quality of sleep. From the scatterplot below, we concluded that in fact, bed time does not have any impact on the sleep quality. There is no linear relationship; some participants who went to bed later than “usual” have a higher sleep quality than most participants who went to bed early. Similar conclusion can be made for the time a participant got out of bed. The data has high variance and so we cannot conclude that a relationship between bed times and sleep quality exists. This conclusion can be justified logically as well - if anything should affect the sleep quality it most likely would be the amount of tiredness the participant feels and total time they slept the day before. Given these quantities, bed time shouldn’t affect sleep at all. Since the dataset does not measure these quantities we can assume them to be latent variables. In the coming sections we will analyze the activity log of each user with respect to their sleep quality. 5.2.2 Does Your Build Affect Your Sleep? It has been seen that as a person ages their quality of sleep deteriorates. This is attributed to many things pertaining to the process of aging that results the gradual death of many cells including neurons in the brain. To test this hypothesis, we decided to analyze the relationship between age and our sleep quality metric. It is surprising to see a general trend appear, excluding certain outliers. Sleep quality seems to be linearly correlated to age till a threshold of 30 years. We see a sharp decline in sleep quality for participants who are older than 30 years. Moreover, sleep quality seems to remain more or less constant beyond that threshold. Does that mean we can conclude that as a person ages their sleep quality deteriorates? Not entirely, as the cohort sample age is extremely skewed towards the left hand side i.e. we have more participants that are young adults in comparison to those who are middle aged. Again, we make this conclusion bearing in mind that it might fail with the addition of participants that are middle aged. The next question was - what about height? Do taller people sleep better? The trend that emerges from the scatterplot says probably not. We use the word probably because we have to keep in mind the limitation of the small size of the dataset and also the left skewness of the dataset when it comes to height. However, we still see close to a linear relationship between M and height where the increase in latter leads to a decrease in former. This could be for many reasons one of which could be that it is easier for short people to get comfortable in bed which helps with how well they sleep. It is important to keep in mind that the aim of this project is not to determine a DAG (directed acyclic graph) of all variables that are possibly correlated but to see if a varaible has any effect on our metric. So, the reasons supplied here is an attempt to understand why something could be happening without really having any measurements and hence should be taken lightly. We then moved on to asking the same questions but for weight of participants. As expected, there seems to be no direct relationship with sleep quality and weight. This can be seen by the scatterplot below and from the spread of the data. Since the authors of the data only studied males, we cannot comment on if one gender is inclined to have a better sleep quality universally than another gender. We refrained from adding more level in the last of the scatterplots as we know that gender system is non-binary. 5.2.3 How Do Different Activities Affect Sleep Quality? From the Activity.csv, we explored the correlation between the sleep quality metric we defined and the total time each user spent on each activity throughout the day. Referring to the graph below, we decided to discuss the common factors, such as heavy activities, screen usage. Initially, we were also curious about the alcohol and caffeine consumption. However, the data was not enough to perform such analysis. The correlation between the total time each user spent on each activity and the sleep quality metric is shown below. Here, we only cared about how the factors affect sleep quality. From the heat map, it is clear there are no significant correlation factors. Next, we tried to group the factors and took time factor into consideration. Will using screen before sleeping affect users’ sleep quality? We first explored small screen usage and large screen usage individually. Overall, it is less likely that using small screen device 4 hours before sleep will affect sleep quality. 5.2.4 How do Biomarkers Affect Sleep Quality? Research has shown that cortisol and melatonin are hormones produced by our body that regulate circadian rhythm and our internal body clock. Melatonin eases you into sleep and helps you stay asleep. The production of melatonin is triggered by darkness and is inhibitted by light. This means that people who sleep well are expected to have a high concentration of melatonin before going to sleep and much lesser when they wake up. Cortisol helps you get up and keeps you awake. So, in conclusion, to be able to sleep well you should have low levels of cortisol before sleeping and high levels after you wake up as cortisol and melatonin have opposing rhythms. We wanted to see how our metric performs against these biomarkers and plotted a bar graph of differences in concentration (before sleep - after sleep) for each of the hormones and participants. Since the actual concentrations of melatonin run in \\(10^{-9}\\) the differences are really not small and range from -10 to 10, given the scale. We saw that only three users/participants have negative cortisol difference levels. To better understand if our metric catches the affects of these hormones on sleep quality, we generated a bar graph of M. There isn’t any “obvious” relationship between our metric and the hormones. However, our metric does seem to catch the anomalies like user 2 and 12 that fall on the two extremes. User 2 scored the lowest on sleep quality and has the highest differnece in cortisol levels among the cohort. The presence of more melatonin indicates a possibility of circadian rhythm of user 2 being messed up. In case of user 12, he is the only participant with an ideal combination of differences in concentration levels and also has the highest sleep quality among all. There are users that don’t follow a trend like user 1. One would think that user 1 would have low sleep quality given the differences but in fact ranks second in sleep quality. "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component "],["conclusion.html", "Chapter 7 Conclusion", " Chapter 7 Conclusion We successfully defined a metric quantifying the sleep quality of participants in MMASH dataset. We saw that bed time does not affect sleep quality but age and height does, although the relationship isn’t very strong. It was interesting to see that our metric captured sleep regulation by cortisol and melatonin in the case of some users. The biggest limitation we faced was due to the small sample size and low diversity in the cohort. Due to these limitations the conclusions made are to be believed keep the possibility of over-fitting in mind. We believe that future work can expand on the following - Increasing sample size by combining datasets with similar depth of sampling and variables Imputing sleep quality value for user 11 having established all causal relationships Include data corresponding to subjective matters like mental health, stress and anxiety in analysis to better quantify sleep quality "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
