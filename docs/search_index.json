[["index.html", "MultilevelSleepAnalysis Chapter 1 Introduction", " MultilevelSleepAnalysis Shruti Kaushal &amp; Clarissa Tai 2021-12-13 Chapter 1 Introduction This project is focused on characterizing the sleep quality of 20 healthy young adults using numerous variables like age, sex, sleep fragmentation index, mental state and heart rate to name a few. There are variables that seems to have a direct relationship with sleep, for example, sleep fragmentation index and the time spent in bed, but there are others that one wouldn’t suspect being related, like height or weight of the user. Biologists may argue that they are indeed related through many different paths but as data scientists we would like to uncover those through the data. The first step is to formulate a metric for the quality of sleep using only the variables that we know are correlated to it. This would mean defining a metric over the set of variables in the sleep.csv file of every user. Preliminary analysis is done to prevent multicollinearity. Once we have established an tested our metric, we will move on to looking into how other variables affect the distribution of the metric across users. This section will be aimed at answering questions about correlation and causality. Our ultimate goal is to identify any confounders if any and quantify their relationship with the metric we define. However, we are cognizant of the fact that the cohort size is extremely small and the results might be “overfitting” the data. That said, we were not able to find any other datasets with the same level of sampling measurements which is why we exercise caution when making all the conclusions in the upcoming sections. Note: Since we are dealing with continuous categorical data, we use scatterplots and linear regression models to establish correlations and/or causal effects "],["data-sources.html", "Chapter 2 Data sources 2.1 Dataset Overview 2.2 Data Collection", " Chapter 2 Data sources Multilevel Monitoring of Activity and Sleep in Healthy People: https://physionet.org/content/mmash/1.0.0/ CAP Sleep Database: https://physionet.org/content/capslpdb/1.0.0/ 2.1 Dataset Overview There are 22 folders in the MMASH dataset corresponding to the 22 healthy male young adults that were monitored for two consecutive days. A myriad of variables were measured for each of the samples or “users” including mental state, heart rate, level of clock genes in saliva, amount of sleep to the different activities that the user does throughout the days. These measurements are organized into 7 folders i.e. for each of the 22 users we have the following 7 folders: Actigraph.csv: accelerometer and inclinometer data recorded throughout the day. Activity.csv: list of the activity categories throughout the day. questionnaire.csv: scores for all the questionnaires. RR.csv: beat-to-beat interval data. saliva.csv: clock genes and hormones concentrations in the saliva before going to bed and after waking up. Melatonin levels are reported in μg of melatonin per μg of protein, while cortisol levels are in μg of cortisol per 100 μg of protein. No clock genes and hormones concentrations data was provided for User_21 due to problem in the salivary samples that do not permit to analyse it. sleep.csv: information about sleep duration and sleep quality of the participant. user_info.csv: anthropocentric characteristics of the participant, such as age, height, weight, etc. ## [1] &quot;user_11 is missing sleep.csv information, having errorError in `[&lt;-.data.frame`(`*tmp*`, \\&quot;user\\&quot;, value = \\&quot;user_11\\&quot;): replacement has 1 row, data has 0\\n&quot; 2.2 Data Collection According to the document, the data were collected and provided by BioBeats (biobeats.com) in collaboration with researchers from the University of Pisa. BioBeats operates in the health science industry that produces IoT wearable devices aiming to detect people’s psychophysiological stress. The data were recorded by sport and health scientists, psychologists and chemists with the objective of assessing psychophysiological response to stress stimuli and sleep. 22 healthy young adult males were recruited. In accordance with the Helsinki Declaration as revised in 2013, the study was approved by the Ethical Committee of the University of Pisa (#0077455/2018). At the start of the data recording, anthropomorphic characteristics (i.e. age, height and weight) of the participants were recorded. At the same time, participants filled in a set of initial questionnaires that provide information about participants psychological status: Morningness-Eveningness Questionnaire (MEQ) State-Trait Anxiety Inventory (STAI-Y) Pittsburgh Sleep Quality Questionnaire Index (PSQI) Behavioural avoidance/inhibition (BIS/BAS) During the test, participants wore two devices continuously for 24 hours: a heart rate monitor to record heartbeats and beat-to-beat interval, and an actigraph to record actigraphy information such as accelerometer data, sleep quality and physical activity. Moreover, the perceived mood (Positive and Negative Affect Schedule - PANAS) were recorded at different times of the day (i.e. 10, 14, 18, 22 and 9 of the next day). Additionally, participants filled in Daily Stress Inventory (DSI) before going to sleep, to summarize the stressful events of the day. Twice a day (i.e., before going to bed and when they woke up) the subjects collected saliva samples at home in appropriate vials. Saliva samples were used to extract RNA and measure the induction of specific clock genes, and to assess specific hormones. A washout period from drugs of at least a week was required from the participants in the study. "],["data-transformation.html", "Chapter 3 Data transformation 3.1 Sleep 3.2 Actigraph 3.3 Activity 3.4 Saliva 3.5 User info", " Chapter 3 Data transformation As mentioned in the introduction, for each sample or “user” many variables were sampled over the course of two days. These measurements are organized into 7 different files and in this section we will focus on how we transformed the data in each of the files for analysis. We worked on all the datetime columns and transformed them into the format YYYY-MM-DD HH:MM:SS for convenience. We decided to not include RR.csv in our discussion, since the heartbeat information is also included in the actigraph.csv. 3.1 Sleep The sleep file includes measurements like the time the user gets into bed to total minutes spent in bed, total sleep time, number of times the user wakes up etc. Every user once in bed (to sleep) doesn’t get out of bed till morning except one. Sleep records of user 1 showed that he got out of bed at 3:31 AM and went back to sleep at 3:57 AM. For simplification, we treated the time interval that the user was out of bed as an “awakening” i.e. when a user awaken from his sleep and remains awake for some time. This required updating the rest of the variables and depending on the definition , we either took the average or maximum or summed the two quantities corresponding to each of the “sleep sessions”. For example, “Total Sleep Time” was now the sum of the sleep time in both sessions, while “Sleep Fragmentation Index” was averaged across sessions. Sleep Measurements of User 1 3.2 Actigraph Actigraph.csv contained accelerometer and inclinometer data recorded throughout the day. Overall, it tracked users’ movement data, such as steps, direction, acceleration, positions, etc. We transformed the data as follows - Datetime format: We transform the time column into datetime type in R. Also, since initial time column doesn’t contain date information, we add days according to the day column to create a relative time stamp for each record in order to facilitate future calculation. Create category Position: Here we gathered columns with inclinometer information, which were Inclinometer.Off, Inclinometer.Standing, Inclinometer.Sitting, Inclinometer.Lying, transformed them into categorical column Position. By doing so, we can explore data correlations under groups of position throughout the day. 3.3 Activity This file contained information on 13 different categories of activities measured throughout the day and the time (of event happening) recorded. We transformed the data as follows - Datetime format: Here we substitute “00:00” to “24:00” in column End to avoid calculating between wrong dates, and then transformed into the format as we did for Actigraph.csv. Relabel the activities: The document labeled the activity categories from 1 to 12. However, an extra category, labeled as 0, also included in the dataset. In this project, we will assume that the 0 represented undetermined activities. Here, we also had to deal with several minor mistakes in the dataset manually. Calculate duration for each activity: To figure the total time each user spent on each activity, we calculate time intervals (End - Start) between different activities in seconds. 3.4 Saliva Saliva.csv collected Melatonin and Cortisol concentrations in the saliva for each participants before going to bed and after waking up. From each of the two samples, the concentration of cortisol and melatonin were calculated. Melatonin levels are reported in μg per μg of protein while cortisol levels are reported in μg per 100 μg of protein. The data contains the normalized concentrations of both hormones and so no transformation or normalization was needed to use this data. 3.5 User info This file contains anthropocentric characteristics of the participant which include the gender, height in centimeters, weight in kgs and age in years. The data is pretty standard and did not require any sort of transformation "],["missing-values.html", "Chapter 4 Missing values 4.1 Missing Value Plot", " Chapter 4 Missing values Missing information includes - file information missing: user_11 is missing sleep.csv information No clock genes and hormones concentrations data was provided for User_21 due to problem in the salivary samples that do not permit to analyse it. Missing age for user_18 in user_info Only user_13 has missing values in questionnaire record Since the aim of our project is to define a metric for sleep quality and identify variables with that affect it, user 11 was excluded from all the analysis performed. 4.1 Missing Value Plot Here we revise the function we created in problem set 4 to plot the missing patterns. The number of missing values are very few (mentioned above). We generated missing value plots only for questionnaire and activity as they seemed to exhibit some pattern. As shown in the plots, only one row with missing values exist in activity and questionnaire, respectively. There is only one missing value in “End” variable which is defined as the time of the day when the event or activity concluded. For example, if a user smoked from 10:30 AM to 10:40 AM then End would be set to 10:40 AM. Except this one missing value, all others are complete cases. Similar to activity, this file category has only two patterns - complete cases and two missing values that correspond to the levels of a variable “PANAS”. PANAS is defined as the positive and negative affect schedule. It gives a score rating between 5 and 50 for both positive and negative emotions and higher the value, the higher is the perceived emotion. There is only one row that is not complete and is present in the records of user 13. "],["results.html", "Chapter 5 Results 5.1 Metric Formulation 5.2 Establishing Direct &amp; Indirect Effects on Sleep Quality", " Chapter 5 Results The results chapter is broadly divided into two sections - one for each of the goals of this project. The first section will document all preliminary findings related to the sleep measurements and the procedure of defining a metric for quantifying quality of sleep. 5.1 Metric Formulation 5.1.1 Preliminary Observations Formulating a metric requires an extensive analysis of the data to identify correlated variables. This is to avoid multicollinearity while defining the metric. Below is a correlation heatmap we generated for variables that do not have the format of a time stamp (for example hh:mm). We made the following observations - Latency, defined as the time taken for the user to fall asleep after he gets into bed, does not seem to be correlated with anything Total sleep time (TST) is not correlated with neither Number of Awakenings and Average Awakening Length. One would expect TST to be negatively correlated to both but that is not true Movement, Fragmentation and Sleep Fragmentation index are highly correlated. It is not surprising as sleep fragmentation index is defined as the ratio of the two Wake After Sleep Onset (WASO) is strongly positively correlated to almost every variable except for Efficiency Efficiency, defined as percentage of sleep time on total sleep in bed, surprisingly is not correlated to Total Minutes in Bed Note: all coefficients are statistically significant with a default critical value of 0.05 5.1.2 Distribution of Variables There are 3 clusters in the heatmap (if we cut across the tree right below the highest line connecting efficiency and another cluster) which are consistent with the observations we made. To avoid multicollinearity, we picked variables from each of the clusters depending on the strength and significance of the correlation coefficient. We denote our metric by M. Intuitively, it should be higher for users who are able to sleep through the night and do not have any trouble falling asleep. Keeping this in mind, we came up with the following associations - M \\(\\alpha\\) Total Sleep Time (TST) M \\(\\alpha\\) \\(\\frac{1}{SleepFragmentation Index}\\) M \\(\\alpha\\) \\(\\frac{1}{Latency}\\) M \\(\\alpha\\) \\(\\frac{1}{AverageTimeSpentAwake}\\) We combined the above associations as follows - \\[\\begin{align*} M \\alpha (\\frac{TST}{AverageTimeSpentAwake} + \\frac{1}{SleepFragmentationIndex}).\\frac{1}{Latency} \\end{align*}\\] The units of the right hand side are “per hh:mm” (because of addition of latency). Average Time Spent Awake is the product of Number of Awakenings and Average Awakening Length. Let the ratio of TST and Average Time Spent Awake be called sleep ratio. Next, we quantified the distribution of variables involved in defining M. We wanted to include informative variables instead of the ones that remain constant across the cohort. Due to the small sample size, any analysis of such sort (constructing a metric) will have a selection bias and so the conclusions made throughout this section may not hold for a bigger cohort. The box plot below shows the distribution of the Sleep Ratio and Sleep Fragmentation Index. The values for both ratios seems well distributed with no outliers. Since Latency is not a ratio, we visualized it separately as a Cleveland dot plot. There are a lot users with latency time of 0 mins which is a problem since M is inversely proportional to latency. So, we added a dummy term to latency and replaced proportionality with equality (we assume proportionality constants to be 1 - discussed in Conclusions chapter) We define the sleep quality of a user as - \\[\\begin{align*} M = (\\frac{TST}{AverageTimeSpentAwake} + \\frac{1}{SleepFragmentationIndex}).(\\frac{1}{Latency + 1}) \\end{align*}\\] In the case that other variables are 0, we simply replace them by 1. We did not add dummy terms as the none of the users in our cohort have \\(TST = 0\\) or \\(Number of Awakenings = 0\\). M is always positive as all the variables involved are non-negative. 5.1.3 Distribution of Sleep Quality Metric We calculated the sleep quality metric for all users and visualized the results as a boxplot. The lowest value is 0.5902 corresponding to user 2 and the largest is 16.33 corresponding to user 12, who is also an outlier. We are interested in investigating users that fall below the lower hinge (users 2, 3, 8, 10, 16) and above the upper hinge (users 1, 12, 14, 20, 21). ## min lower-hinge median upper-hinge max ## 0.5902389 1.2815906 3.0779926 6.6873567 16.3742315 Having defined M, we wanted to see if it is capturing the quality of sleep. We used Efficiency to evaluate its accuracy. Given the definition of Efficiency, it should be positively correlated to M. To test the relationship, we generated a log-log scale plot. We used a log10 scale to normalize the values and to see how the magnitudes of the two variables are related. The regression model is statistically significant with a p-value of 3.681e-05. Positive slope suggests that as M increases, efficiency also increases. However, the adjusted R square value is 0.6 which means that the model captures less than 70% of the variance. In summary, the metric defined by the formula above seems to be capturing the information that directly affects the sleep quality of a user. Moreover, the statistical significance combined with the positive slope of the regression model and line prove to be a sanity check for our metric. 5.2 Establishing Direct &amp; Indirect Effects on Sleep Quality In this section, we tried to identify variables that are correlated to sleep quality in some way. The relationships identified cannot be interpreted to be causal as correlation doesn’t imply causation. This section is divided further into subsections for each file in the dataset. Due to redundancy in data, we analyzed only 4 out of the 7 files - sleep records, user information, activities performed and saliva samples. 5.2.1 Does Bed Time Affect Sleep Quality? The practice going to bed early and rising early is encouraged for better sleep and health. We wanted to test this hypothesis using our metric. We generated a scatterplot and concluded that bed time does not have affect sleep quality. There is no linear relationship; some participants who went to bed later than “usual” have a higher sleep quality than most participants who went to bed early. Similar conclusion can be made for the time a participant got out of bed. The data has high variance and so we cannot conclude that bed times and sleep quality are related. This can be justified as sleep quality is most likely to be affected by how tired the user feels and total time they slept the day before. ## [1] &quot;user_1&quot; &quot;user_2&quot; &quot;user_3&quot; &quot;user_4&quot; &quot;user_5&quot; &quot;user_6&quot; &quot;user_7&quot; ## [8] &quot;user_8&quot; &quot;user_9&quot; &quot;user_10&quot; &quot;user_12&quot; &quot;user_13&quot; &quot;user_14&quot; &quot;user_15&quot; ## [15] &quot;user_16&quot; &quot;user_17&quot; &quot;user_18&quot; &quot;user_19&quot; &quot;user_20&quot; &quot;user_21&quot; &quot;user_22&quot; 5.2.2 Does Age and Build Affect Sleep Quality? It has been seen that as a person ages their quality of sleep deteriorates. We analyzed the relationship between age and our sleep quality metric to see if such a pattern emerges. A general trend appeared in the scatterplot, excluding certain outliers. M seems to be linearly related to age till a threshold of 30 years. We saw a sharp decline in sleep quality for users older than 30 years. Moreover, sleep quality remained more or less constant beyond the threshold and is much lower compared to young adults. It is important to keep in mind that sample ages are extremely skewed and so similar pattern might not emerge with the addition of more middle aged users. Next, we wanted to see if taller people sleep better or not. Similar to the ages, height of users is also skewed. However, we still see close to a linear relationship with a negative slope between M and height till 190 cm. One reason could be, it is easier for short people to get comfortable in bed and that helps them sleep better. We did not categorize users as outliers due to small sample size and low diversity. We then moved on to see if weight affects sleep quality. As expected, there seems to be no direct relationship between the two. The scatterplot shows the spread of the data which doesn’t have any discernible pattern. Users with weight 70 kg and 80 kg have a range of values for sleep quality. Since the authors of the data only studied males, we cannot conclude if one gender is inclined to have better sleep quality than another. We refrained from adding more geneder levels in the plot to be politically correct. 5.2.3 Which Activities are Deterimental to Sleep Quality? From the Activity.csv, we explored the correlation between the sleep quality metric and the total time each user spent on each activity throughout the day. We generated a heatmap of the time each user spends on each activity. The blank spaces mean that the user did not engage in that activity at all. Initially, we were curious about alcohol and caffeine consumption but the amount of data was too less to analyze. We decided to discuss screen usage and heavy activities. The correlation between the total time each user spent on each activity and the sleep quality metric is shown below. It can be seen that M is positively correlated to screen usage which seems counterintuitive. So, we extracted the p-values corresponding to the correlation matrix and found that none of the coefficients (including M) were statistically significant. To dig deeper, we looked at the relationship between the amount off-screen time the user has right before sleeping and the sleep metric. We expected to have a positive linear relationship. However, from the regression lines below we see that the relationship is neither linear nor positive. Plot with averaged small and large off-screen time is comparatively closer to our expectations but the standard errors are too large to ignore. 5.2.4 How do Biomarkers Affect Sleep Quality? Research has shown that cortisol and melatonin are hormones produced by the body that regulate circadian rhythm and internal body clock. Melatonin eases you into sleep and helps you stay asleep. Its production is triggered by darkness and inhibitted by light. Cortisol helps you get up and keeps you awake. In summary, cortisol and melatonin have opposing rhythms. The prerequisites of a good sleep include having low cortisol and high melatonin levels before going to sleep and low melatonin and high cortisol levels after waking up. We wanted to see if our metric is able to capture the presence of prerequisites or not. We plotted a bar graph of differences in concentration (before sleep - after sleep) for each of the hormones and users. Concentrations of melatonin run in \\(10^{-9}\\) and so the differences are not small, given the scale. We saw that only three users have negative cortisol difference levels. To simulateneously compare the differences with M, we generated a bar graph for sleep quality of all users. There isn’t any “obvious” relationship between our metric and the hormones. However, our metric does seem to catch users like user 2 and 12 that fall on the two extremes. User 2 scored the lowest on sleep quality and has the highest positive differnece in cortisol levels in the cohort and the rhythm of melatonin is the same as cortisol’s. User 12 is the only participant with opposing rhythms and also has the highest sleep quality among all. There are users that don’t follow a trend like user 1. One would think that user 1 would have low sleep quality given the differences but in fact ranks second in sleep quality. "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component Sleep Quality (M) avg.Cortisol avg.Melatonin diff.Cortisol diff.Melatonin "],["conclusion.html", "Chapter 7 Conclusion", " Chapter 7 Conclusion We successfully defined a metric quantifying the sleep quality of participants in MMASH dataset. We saw that bed time does not affect sleep quality but age and height do, although the relationship isn’t very strong. It was interesting to see that our metric captured sleep regulation by cortisol and melatonin in the case of some users. However, the results we got for screen usage were counter-intuitive, given that increased screen exposure is known to trigger inhibition of melatonin and release of cortisol. A lot of improvements can be done in defining the metric. The biggest limitation was the small sample size and low diversity in the cohort. Due to these limitations the conclusions made are to be believed keep the possibility of over-fitting in mind. We believe that future work can expand on the following - Increasing sample size by combining datasets with similar depth of sampling and variables Imputing sleep quality value for user 11 having established all causal relationships Include data corresponding to subjective matters like mental health, stress and anxiety in analysis to better quantify sleep quality Replacing proportionality with equality along with the introduction of proportionality constants. More data is required to accurately determine the values of these constants and so for simplicity we assumed them to be equal to 1 when performing analysis "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
